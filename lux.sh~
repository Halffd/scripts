#!/bin/bash

# Check if the correct number of arguments is provided
if [ "$#" -ne 1 ]; then
    echo "Usage: $0 <brightness_value>"
    exit 1
fi

# Assign parameters to variables
BRIGHTNESS_VALUE=$1

# Check if brightness value is a valid number
if ! [[ "$BRIGHTNESS_VALUE" =~ ^[0-9]*\.?[0-9]+$ ]]; then
    echo "Error: Brightness value must be a number."
    exit 1
fi

# Convert brightness to a float
BRIGHTNESS_VALUE=$(echo "$BRIGHTNESS_VALUE" | awk '{printf "%.2f", $0}')

# Check if brightness is below 0 or above 1
if (( $(echo "$BRIGHTNESS_VALUE < 0.0" | bc -l) )) || (( $(echo "$BRIGHTNESS_VALUE > 1.0" | bc -l) )); then
    echo "Error: Brightness value must be between 0.0 and 1.0."
    exit 1
fi

# Detect connected monitors
CONNECTED_MONITORS=$(xrandr | grep " connected" | awk '{ print $1 }')

# Set brightness for each connected monitor
for MONITOR in $CONNECTED_MONITORS; do
    xrandr --output "$MONITOR" --brightness "$BRIGHTNESS_VALUE"
    echo "Brightness set to $BRIGHTNESS_VALUE for $MONITOR."
done
